<!DOCTYPE html>
<html>

<head>
    <base href="/openstreetmap">
    <title>Emrit OSM</title>
    <link rel="icon" href="https://emrit.comorin.co/openstreetmap/assets/markerLogo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="x-ua-compatible" content="IE-edge">
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <style>
        html,
        body {
            height: 100%;
            padding: 0;
            margin: 0;
        }

        #map {
            /* configure the size of the map */
            width: 100%;
            height: 100%;
        }

        .modal.custom .modal-dialog {
            position: fixed;
            bottom: 0;
            margin: auto;
            right: 25%;
            left: 25%;
        }

        .bottomBox {
            background: rgb(37, 37, 37);
            background: linear-gradient(90deg, rgb(37 37 37 / 25%) 0%, rgb(37 37 37 / 58%) 0%, rgba(88, 88, 99, 1) 47%, rgba(37, 37, 37, 1) 100%);
            padding: 15px;
            margin: 10px;
            position: fixed;
            bottom: 0;
            z-index: 1050;
            right: 0;
            border-radius: 10px;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#"><img src="https://emrit.comorin.co/images/emrit_logo.png" width="118px"></a>
    </nav>
    <div id="map"></div>
    <!-- Modal Dialog Start -->
    <div id="mymodal" class="modal fade custom" tabindex="-1" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <h4 class="modal-title"> Hotspot details: <span id="demo"></span>
                    </h4>

                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p><strong>Accout ID: </strong><br><span
                            style="word-wrap: break-word">143ZDp7mCcgurqGZW4ppK7P87XC2Jw1NEZwVuN3UTGfTmxX9zWL</span></p>
                    <p><strong>Total HNT: </strong>1,378.32</p>
                    <p><strong>Name: </strong>shiny-velvet-yak</p>
                    <p><strong>Location: </strong> Tucson, AZ, United States</p>
                    <p><strong>Score: </strong>0.01</p>
                    <p><strong>Activity Log: </strong><br> with transactions identified by hashes like:
                        VAG15EvEwsulxZNBNnBSpdMJlofouQZozaa9zRmuOtY, block height, data_credits, poc_challengers,
                        poc_witnesses, poc_challengees, and consensus</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal Dialog End -->
    <div class="bottomBox">
        <div class="col-lg-12 text-center">
            <img src="https://emrit.comorin.co/openstreetmap/assets/markerLogo.png" width="43px">
        </div>
        <div class="col-lg-12 text-center pt-2">
            <h4 class="mb-0" style="color: white;" id="hotspots"></h4>
        </div>
    </div>
    <script>
        var greenIcon = L.icon({
            iconUrl: 'https://emrit.comorin.co/openstreetmap/assets/markerLogo.png',
            shadowUrl: 'https://emrit.comorin.co/openstreetmap/assets/markerLogo.png',
            iconSize: [12, 12], // size of the icon
            shadowSize: [12, 12], // size of the shadow
            iconAnchor: [22, 94], // point of the icon which will correspond to marker's location
            shadowAnchor: [4, 62],  // the same for the shadow
            popupAnchor: [-3, -76] // point from which the popup should open relative to the iconAnchor
        });

        var locations = [
            [
                ["Lingarajapuram", 13.0130, 77.6262, "coolspots"],
                ["Kasturi Nagar", 13.0061, 77.6594, "wifi"],
                ["Indiranagar", 12.9784, 77.6408, "coolspots"],
                ["Ambalipura ", 12.9150, 77.6701, "helium"],
                ["Yamare ", 12.8705, 77.7595, "helium"],
                ["Balagere", 12.9396, 77.7290, "coolspots"],
                ["Nerige", 12.9116, 77.7760, "wifi"],
                ["Sarjapura", 12.8576, 77.7864, "helium"],
            ],
            [
                ["Attingere", 12.8710, 77.2798, "helium"],
                ["Savandurga ", 12.9206, 77.2944, "coolspots"],
                ["Sulivara", 12.9040, 77.3624, "wifi"],
                ["Chikkanahalli", 12.8813, 77.3549, "coolspots"],
                ["Yelachaguppe", 12.9563, 77.4272, "helium"],
                ["Mathikere", 13.0204, 77.4673, "wifi"],
                ["Kadabagere", 12.9969, 77.4331, "coolspots"],
            ]
        ];

        // initialize Leaflet 
        var map = L.map('map').setView({ lon: 77.5946, lat: 12.9716 }, 8);

        // add the OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'
        }).addTo(map);

        // show a marker on the map
        L.control.scale().addTo(map);

        // create a red polygon from an array of LatLng points
        var latlngs = [
            [
                [13.0552, 77.6422],
                [13.0354, 77.5988],
                [12.9030, 77.6242],
                [12.8304, 77.8662]
            ],
            [
                [12.8041, 77.3143],
                [12.8818, 77.1544],
                [13.0607, 77.5118]
            ]
        ];

        for (var i = 0; i < latlngs.length; i++) {
            polygon = L.polygon(latlngs[i], { color: 'black' }).addTo(map);
            polygon.myID = i;
            polygon.on('click', polygonOnClick);
        }


        var cordata = []

        function polygonOnClick(e) {
            console.log(map.getZoom());
            console.log('asfasfasf', e)
            var hotspotcount = 1;
            map.fitBounds(e.target.getBounds());
            // show a marker on the map
            if (cordata.length > 0) {
                cordata = []
            } else {
            }
            for (var i = 0; i < locations[e.target.myID].length; i++) {
                cordata.push(locations[e.target.myID][i])
            }
            console.log('asfasfasf', cordata)
            for (var i = 0; i < cordata.length; i++) {
                if (cordata[i][3] == "wifi") {
                    marker = new L.circleMarker([cordata[i][1], cordata[i][2]], { color: 'blue' })
                        .bindPopup(cordata[i][0])
                        .addTo(map).setRadius(5);
                } else if (cordata[i][3] == "helium") {
                    marker = new L.circleMarker([cordata[i][1], cordata[i][2]], { color: 'red' })
                        .bindPopup(cordata[i][0])
                        .addTo(map).setRadius(5);
                } else {
                    document.getElementById("hotspots").innerHTML = hotspotcount++
                    // marker = new L.Marker([cordata[i][1], cordata[i][2]], { icon: greenIcon })
                    marker = new L.circleMarker([cordata[i][1], cordata[i][2]], { color: 'green' })
                        .addTo(map).setRadius(5);;
                    marker.myID = i;
                    marker.on('click', function (e) {
                        document.getElementById("demo").innerHTML = cordata[e.target.myID][0];
                        $('#mymodal').modal('show');
                    });
                }
            }
        }

        // L.marker({ lon: 77.646843, lat: 13.061296 }).addTo(map).on('click', markerOnClick);

    </script>
</body>

</html>